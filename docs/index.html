<!DOCTYPE html><html class="default" lang="en" data-base="."><head><meta charset="utf-8"/><meta http-equiv="x-ua-compatible" content="IE=edge"/><title>effect-lambda</title><meta name="description" content="Documentation for effect-lambda"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="assets/style.css"/><link rel="stylesheet" href="assets/highlight.css"/><script defer src="assets/main.js"></script><script async src="assets/icons.js" id="tsd-icons-script"></script><script async src="assets/search.js" id="tsd-search-script"></script><script async src="assets/navigation.js" id="tsd-nav-script"></script></head><body><script>document.documentElement.dataset.theme = localStorage.getItem("tsd-theme") || "os";document.body.style.display="none";setTimeout(() => app?app.showPage():document.body.style.removeProperty("display"),500)</script><header class="tsd-page-toolbar"><div class="tsd-toolbar-contents container"><div class="table-cell" id="tsd-search"><div class="field"><label for="tsd-search-field" class="tsd-widget tsd-toolbar-icon search no-caption"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" aria-hidden="true"><use href="assets/icons.svg#icon-search"></use></svg></label><input type="text" id="tsd-search-field" aria-label="Search"/></div><div class="field"><div id="tsd-toolbar-links"></div></div><ul class="results"><li class="state loading">Preparing search index...</li><li class="state failure">The search index is not available</li></ul><a href="index.html" class="title">effect-lambda</a></div><div class="table-cell" id="tsd-widgets"><a href="#" class="tsd-widget tsd-toolbar-icon menu no-caption" data-toggle="menu" aria-label="Menu"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" aria-hidden="true"><use href="assets/icons.svg#icon-menu"></use></svg></a></div></div></header><div class="container container-main"><div class="col-content"><div class="tsd-page-title"><h1>effect-lambda</h1></div><div class="tsd-panel tsd-typography"><a id="effect-lambda" class="tsd-anchor"></a><h1 class="tsd-anchor-link">effect-lambda<a href="#effect-lambda" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h1><p><a href="https://www.npmjs.com/package/effect-lambda"><img src="https://img.shields.io/npm/v/effect-lambda" alt="NPM Version"></a> <img src="https://img.shields.io/npm/dt/effect-lambda?label=Total%20Downloads" alt="npm"> <img src="https://img.shields.io/npm/dw/effect-lambda?label=Weekly%20Downloads" alt="npm"> <a href="https://successkrisz.github.io/effect-lambda/"><img src="https://img.shields.io/badge/GitHub%20Pages-Online-brightgreen" alt="GitHub Pages"></a></p>
<p>Effect friendly wrapper for AWS Lambda functions.</p>
<blockquote>
<p><strong>Disclaimer:</strong> This library is still in early development stage and the API is likely to change. Feedback is welcome.</p>
</blockquote>
<a id="motivation" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Motivation<a href="#motivation" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><p>Have been using lambda functions as a primary way to build serverless applications for a while now. Since I made the switch from <code>fp-ts</code> to <code>effect</code>, I wanted to use effects all the way when writing lambda functions, replacing the previous usage of <code>middy</code> and <code>fp-ts</code>. This library is an attempt to provide a functional way to write lambda functions using the <code>effect</code> library. The library is inspired by the <code>@effect/platform</code> library and aims to provide a similar experience for writing lambda functions.</p>
<a id="main-concepts--caveats" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Main Concepts &amp; Caveats<a href="#main-concepts--caveats" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><p><strong>Pros:</strong>
The main approach of this library to use simple Effects as lambda handlers, allowing access at any point to the event and context allowing some really cool patterns.</p>
<ul>
<li>For some of the handlers, this lends itself to more accessible patterns, like an API Gateway handler that provides the payload base64 encoded and stringified in the event body, so being able to abstract away that or normalize headers is quite useful.</li>
<li>Or take an SQS handler which can operate on individual records in a batch, and provide a utility to handle batch failures.</li>
</ul>
<p>Take a look at the following example:</p>
<pre><code class="typescript"><span class="hl-0">import</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-2">APIGatewayProxyEvent</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-2">schemaBodyJson</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-2">toLambdaHandler</span><span class="hl-1">,</span><br/><span class="hl-1">} </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-3">&quot;effect-lambda/RestApi&quot;</span><span class="hl-1">;</span><br/><span class="hl-0">import</span><span class="hl-1"> { </span><span class="hl-2">Effect</span><span class="hl-1">, </span><span class="hl-2">Console</span><span class="hl-1"> } </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-3">&quot;effect&quot;</span><span class="hl-1">;</span><br/><span class="hl-0">import</span><span class="hl-1"> { </span><span class="hl-2">Schema</span><span class="hl-1"> } </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-3">&quot;@effect/schema&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">PayloadSchema</span><span class="hl-1"> = </span><span class="hl-2">Schema</span><span class="hl-1">.</span><span class="hl-6">Struct</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-2">message:</span><span class="hl-1"> </span><span class="hl-2">Schema</span><span class="hl-1">.</span><span class="hl-2">String</span><span class="hl-1">,</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-0">export</span><span class="hl-1"> </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">_handler</span><span class="hl-1"> = </span><span class="hl-6">schemaBodyJson</span><span class="hl-1">(</span><span class="hl-2">PayloadSchema</span><span class="hl-1">).</span><span class="hl-6">pipe</span><span class="hl-1">(</span><br/><span class="hl-1">  </span><span class="hl-2">Effect</span><span class="hl-1">.</span><span class="hl-6">map</span><span class="hl-1">((</span><span class="hl-2">payload</span><span class="hl-1">) </span><span class="hl-4">=&gt;</span><span class="hl-1"> ({</span><br/><span class="hl-1">    </span><span class="hl-2">statusCode:</span><span class="hl-1"> </span><span class="hl-7">200</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-2">body:</span><span class="hl-1"> </span><span class="hl-5">JSON</span><span class="hl-1">.</span><span class="hl-6">stringify</span><span class="hl-1">({ </span><span class="hl-2">message:</span><span class="hl-1"> </span><span class="hl-2">payload</span><span class="hl-1">.</span><span class="hl-2">message</span><span class="hl-1"> }),</span><br/><span class="hl-1">  })),</span><br/><span class="hl-1">  </span><span class="hl-2">Effect</span><span class="hl-1">.</span><span class="hl-6">catchTag</span><span class="hl-1">(</span><span class="hl-3">&quot;ParseError&quot;</span><span class="hl-1">, () </span><span class="hl-4">=&gt;</span><br/><span class="hl-1">    </span><span class="hl-2">Effect</span><span class="hl-1">.</span><span class="hl-6">succeed</span><span class="hl-1">({</span><br/><span class="hl-1">      </span><span class="hl-2">statusCode:</span><span class="hl-1"> </span><span class="hl-7">400</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-2">body:</span><span class="hl-1"> </span><span class="hl-3">&quot;Bad Request&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">    }),</span><br/><span class="hl-1">  ),</span><br/><span class="hl-1">);</span><br/><br/><span class="hl-0">export</span><span class="hl-1"> </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">handler</span><span class="hl-1"> = </span><span class="hl-2">_handler</span><span class="hl-1">.</span><span class="hl-6">pipe</span><span class="hl-1">(</span><span class="hl-6">toLambdaHandler</span><span class="hl-1">());</span><br/><br/><span class="hl-8">// Or you can add a post processing middleware to the handler just by mapping over the effect</span><br/><span class="hl-0">export</span><span class="hl-1"> </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">handlerWithMiddleware</span><span class="hl-1"> = </span><span class="hl-2">_handler</span><span class="hl-1">.</span><span class="hl-6">pipe</span><span class="hl-1">(</span><br/><span class="hl-1">  </span><span class="hl-2">Effect</span><span class="hl-1">.</span><span class="hl-6">map</span><span class="hl-1">((</span><span class="hl-2">response</span><span class="hl-1">) </span><span class="hl-4">=&gt;</span><span class="hl-1"> ({</span><br/><span class="hl-1">    ...</span><span class="hl-2">response</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-2">headers:</span><span class="hl-1"> { </span><span class="hl-3">&quot;Content-Type&quot;</span><span class="hl-2">:</span><span class="hl-1"> </span><span class="hl-3">&quot;application/json&quot;</span><span class="hl-1"> },</span><br/><span class="hl-1">  })),</span><br/><span class="hl-1">  </span><span class="hl-2">toLambdaHandler</span><span class="hl-1">,</span><br/><span class="hl-1">);</span><br/><br/><span class="hl-8">// Or you can add a pre-processing middleware</span><br/><span class="hl-0">export</span><span class="hl-1"> </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">handlerWithPreMiddleware</span><span class="hl-1"> = </span><span class="hl-2">APIGatewayProxyEvent</span><span class="hl-1">.</span><span class="hl-6">pipe</span><span class="hl-1">(</span><br/><span class="hl-1">  </span><span class="hl-2">Effect</span><span class="hl-1">.</span><span class="hl-6">tap</span><span class="hl-1">((</span><span class="hl-2">event</span><span class="hl-1">) </span><span class="hl-4">=&gt;</span><span class="hl-1"> </span><span class="hl-2">Console</span><span class="hl-1">.</span><span class="hl-6">log</span><span class="hl-1">(</span><span class="hl-3">`Received event: </span><span class="hl-4">${</span><span class="hl-2">event</span><span class="hl-4">}</span><span class="hl-3">`</span><span class="hl-1">)),</span><br/><span class="hl-1">  </span><span class="hl-2">Effect</span><span class="hl-1">.</span><span class="hl-6">flatMap</span><span class="hl-1">(() </span><span class="hl-4">=&gt;</span><span class="hl-1"> </span><span class="hl-2">_handler</span><span class="hl-1">),</span><br/><span class="hl-1">  </span><span class="hl-6">toLambdaHandler</span><span class="hl-1">(),</span><br/><span class="hl-1">);</span>
</code><button type="button">Copy</button></pre>

<p><strong>Cons:</strong></p>
<ul>
<li>This approach of making the event accessible at any point in the handler requires individual wrappers for each type of event.</li>
<li>When using a layered architecture, the lambda specific wrapper should be fairly thin, essentially just extracting the domain input for the &quot;use case&quot; layer and map back the domain output to the lambda output.</li>
</ul>
<a id="table-of-contents" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Table of Contents<a href="#table-of-contents" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><ul>
<li><a href="#effect-lambda">effect-lambda</a>
<ul>
<li><a href="#motivation">Motivation</a></li>
<li><a href="#main-concepts--caveats">Main Concepts &amp; Caveats</a></li>
<li><a href="#table-of-contents">Table of Contents</a></li>
<li><a href="#installation">Installation</a></li>
<li><a href="#usage">Usage</a>
<ul>
<li><a href="#api-gateway-proxy-handler">API Gateway Proxy Handler</a></li>
<li><a href="#sqs-trigger-handler">SQS Trigger Handler</a></li>
<li><a href="#sns-trigger-handler">SNS Trigger Handler</a></li>
<li><a href="#dynamodb-stream-event-handler">DynamoDB Stream Event Handler</a></li>
</ul>
</li>
<li><a href="#useful-other-libraries-to-use-with-effect-lambda">Useful other libraries to use with effect-lambda</a></li>
<li><a href="#todo-list">TODO list</a></li>
</ul>
</li>
</ul>
<a id="installation" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Installation<a href="#installation" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><p>This library has peer dependencies on <code>@effect/schema</code> and <code>effect</code>. You can install them via npm or pnpm or any other package manager you prefer.</p>
<pre><code class="bash"><span class="hl-8"># pnpm</span><br/><span class="hl-6">pnpm</span><span class="hl-1"> </span><span class="hl-3">add</span><span class="hl-1"> </span><span class="hl-3">effect-lambda</span><span class="hl-1"> </span><span class="hl-3">effect</span><span class="hl-1"> </span><span class="hl-3">@effect/schema</span><br/><span class="hl-8"># npm</span><br/><span class="hl-6">npm</span><span class="hl-1"> </span><span class="hl-3">install</span><span class="hl-1"> </span><span class="hl-3">effect-lambda</span><span class="hl-1"> </span><span class="hl-3">effect</span><span class="hl-1"> </span><span class="hl-3">@effect/schema</span>
</code><button type="button">Copy</button></pre>

<a id="usage" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Usage<a href="#usage" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><p>Currently the library provides handlers for the following AWS Lambda triggers:</p>
<ul>
<li>API Gateway Proxy Handler</li>
<li>SNS Handler</li>
<li>SQS Handler</li>
<li>DynamoDB Stream Handler</li>
</ul>
<p>You can find TypeDocs for this package <a href="https://successkrisz.github.io/effect-lambda/">here</a>.</p>
<a id="api-gateway-proxy-handler" class="tsd-anchor"></a><h3 class="tsd-anchor-link">API Gateway Proxy Handler<a href="#api-gateway-proxy-handler" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-8">// handler.ts</span><br/><span class="hl-0">import</span><span class="hl-1"> { </span><span class="hl-2">RestApi</span><span class="hl-1"> } </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-3">&quot;effect-lambda&quot;</span><span class="hl-1">;</span><br/><span class="hl-0">import</span><span class="hl-1"> { </span><span class="hl-2">Effect</span><span class="hl-1"> } </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-3">&quot;effect&quot;</span><span class="hl-1">;</span><br/><span class="hl-0">import</span><span class="hl-1"> { </span><span class="hl-2">Schema</span><span class="hl-1"> } </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-3">&quot;@effect/schema&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-0">export</span><span class="hl-1"> </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">handler</span><span class="hl-1"> = </span><span class="hl-2">RestApi</span><span class="hl-1">.</span><span class="hl-6">toLambdaHandler</span><span class="hl-1">()(</span><br/><span class="hl-1">  </span><span class="hl-2">Effect</span><span class="hl-1">.</span><span class="hl-6">succeed</span><span class="hl-1">({</span><br/><span class="hl-1">    </span><span class="hl-2">statusCode:</span><span class="hl-1"> </span><span class="hl-7">200</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-2">body:</span><span class="hl-1"> </span><span class="hl-5">JSON</span><span class="hl-1">.</span><span class="hl-6">stringify</span><span class="hl-1">({ </span><span class="hl-2">message:</span><span class="hl-1"> </span><span class="hl-3">&quot;Hello, World!&quot;</span><span class="hl-1"> }),</span><br/><span class="hl-1">  }),</span><br/><span class="hl-1">);</span><br/><br/><span class="hl-8">// Or access the payload and path parameters from the event</span><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">PayloadSchema</span><span class="hl-1"> = </span><span class="hl-2">Schema</span><span class="hl-1">.</span><span class="hl-6">Struct</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-2">message:</span><span class="hl-1"> </span><span class="hl-2">Schema</span><span class="hl-1">.</span><span class="hl-2">String</span><span class="hl-1">,</span><br/><span class="hl-1">});</span><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">PathParamsSchema</span><span class="hl-1"> = </span><span class="hl-2">Schema</span><span class="hl-1">.</span><span class="hl-6">Struct</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-2">name:</span><span class="hl-1"> </span><span class="hl-2">Schema</span><span class="hl-1">.</span><span class="hl-2">String</span><span class="hl-1">,</span><br/><span class="hl-1">});</span><br/><span class="hl-0">export</span><span class="hl-1"> </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">handler</span><span class="hl-1"> = </span><span class="hl-2">RestApi</span><span class="hl-1">.</span><span class="hl-6">toLambdaHandler</span><span class="hl-1">()(</span><br/><span class="hl-1">  </span><span class="hl-2">RestApi</span><span class="hl-1">.</span><span class="hl-6">schemaPathParams</span><span class="hl-1">(</span><span class="hl-2">PathParamsSchema</span><span class="hl-1">).</span><span class="hl-6">pipe</span><span class="hl-1">(</span><br/><span class="hl-1">    </span><span class="hl-2">Effect</span><span class="hl-1">.</span><span class="hl-6">map</span><span class="hl-1">(({ </span><span class="hl-2">name</span><span class="hl-1"> }) </span><span class="hl-4">=&gt;</span><span class="hl-1"> </span><span class="hl-2">name</span><span class="hl-1">),</span><br/><span class="hl-1">    </span><span class="hl-2">Effect</span><span class="hl-1">.</span><span class="hl-6">bindTo</span><span class="hl-1">(</span><span class="hl-3">&quot;name&quot;</span><span class="hl-1">),</span><br/><span class="hl-1">    </span><span class="hl-2">Effect</span><span class="hl-1">.</span><span class="hl-6">bind</span><span class="hl-1">(</span><span class="hl-3">&quot;message&quot;</span><span class="hl-1">, () </span><span class="hl-4">=&gt;</span><br/><span class="hl-1">      </span><span class="hl-2">RestApi</span><span class="hl-1">.</span><span class="hl-6">schemaBodyJson</span><span class="hl-1">(</span><span class="hl-2">PayloadSchema</span><span class="hl-1">).</span><span class="hl-6">pipe</span><span class="hl-1">(</span><span class="hl-2">Effect</span><span class="hl-1">.</span><span class="hl-6">map</span><span class="hl-1">((</span><span class="hl-2">x</span><span class="hl-1">) </span><span class="hl-4">=&gt;</span><span class="hl-1"> </span><span class="hl-2">x</span><span class="hl-1">.</span><span class="hl-2">message</span><span class="hl-1">)),</span><br/><span class="hl-1">    ),</span><br/><span class="hl-1">    </span><span class="hl-2">Effect</span><span class="hl-1">.</span><span class="hl-6">map</span><span class="hl-1">(({ </span><span class="hl-2">name</span><span class="hl-1">, </span><span class="hl-2">message</span><span class="hl-1"> }) </span><span class="hl-4">=&gt;</span><span class="hl-1"> ({</span><br/><span class="hl-1">      </span><span class="hl-2">statusCode:</span><span class="hl-1"> </span><span class="hl-7">200</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-2">body:</span><span class="hl-1"> </span><span class="hl-3">`Hello </span><span class="hl-4">${</span><span class="hl-2">name</span><span class="hl-4">}</span><span class="hl-3">, </span><span class="hl-4">${</span><span class="hl-2">message</span><span class="hl-4">}</span><span class="hl-3">`</span><span class="hl-1">,</span><br/><span class="hl-1">    })),</span><br/><span class="hl-1">    </span><span class="hl-2">Effect</span><span class="hl-1">.</span><span class="hl-6">catchTag</span><span class="hl-1">(</span><span class="hl-3">&quot;ParseError&quot;</span><span class="hl-1">, () </span><span class="hl-4">=&gt;</span><br/><span class="hl-1">      </span><span class="hl-2">Effect</span><span class="hl-1">.</span><span class="hl-6">succeed</span><span class="hl-1">({</span><br/><span class="hl-1">        </span><span class="hl-2">statusCode:</span><span class="hl-1"> </span><span class="hl-7">400</span><span class="hl-1">,</span><br/><span class="hl-1">        </span><span class="hl-2">body:</span><span class="hl-1"> </span><span class="hl-3">&quot;Invalid JSON&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">      }),</span><br/><span class="hl-1">    ),</span><br/><span class="hl-1">  ),</span><br/><span class="hl-1">);</span>
</code><button type="button">Copy</button></pre>

<p>You can use <a href="https://www.npmjs.com/package/helmet">helmet</a> to secure your application using the provided applyMiddleware utility.</p>
<pre><code class="typescript"><span class="hl-0">import</span><span class="hl-1"> { </span><span class="hl-2">applyMiddleware</span><span class="hl-1">, </span><span class="hl-2">RestApi</span><span class="hl-1"> } </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-3">&quot;effect-lambda&quot;</span><span class="hl-1">;</span><br/><span class="hl-0">import</span><span class="hl-1"> </span><span class="hl-2">helmet</span><span class="hl-1"> </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-3">&quot;helmet&quot;</span><span class="hl-1">;</span><br/><span class="hl-0">import</span><span class="hl-1"> { </span><span class="hl-2">Effect</span><span class="hl-1">, </span><span class="hl-2">pipe</span><span class="hl-1"> } </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-3">&quot;effect&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-6">toHandler</span><span class="hl-1"> = (</span><span class="hl-2">effect</span><span class="hl-1">: </span><span class="hl-9">Parameters</span><span class="hl-1">&lt;</span><span class="hl-4">typeof</span><span class="hl-1"> </span><span class="hl-2">RestApi</span><span class="hl-1">.</span><span class="hl-2">toLambdaHandler</span><span class="hl-1">&gt;[</span><span class="hl-7">0</span><span class="hl-1">]) </span><span class="hl-4">=&gt;</span><br/><span class="hl-1">  </span><span class="hl-6">pipe</span><span class="hl-1">(</span><br/><span class="hl-1">    </span><span class="hl-2">effect</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-2">Effect</span><span class="hl-1">.</span><span class="hl-6">map</span><span class="hl-1">(</span><span class="hl-6">applyMiddleware</span><span class="hl-1">(</span><span class="hl-6">helmet</span><span class="hl-1">())),</span><br/><span class="hl-1">    </span><span class="hl-2">RestApi</span><span class="hl-1">.</span><span class="hl-6">toLambdaHandler</span><span class="hl-1">(),</span><br/><span class="hl-1">  );</span><br/><br/><span class="hl-0">export</span><span class="hl-1"> </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">handler</span><span class="hl-1"> = </span><span class="hl-2">Effect</span><span class="hl-1">.</span><span class="hl-6">succeed</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-2">statusCode:</span><span class="hl-1"> </span><span class="hl-7">200</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-2">body:</span><span class="hl-1"> </span><span class="hl-5">JSON</span><span class="hl-1">.</span><span class="hl-6">stringify</span><span class="hl-1">({ </span><span class="hl-2">message:</span><span class="hl-1"> </span><span class="hl-3">&quot;Hello, World!&quot;</span><span class="hl-1"> }),</span><br/><span class="hl-1">}).</span><span class="hl-6">pipe</span><span class="hl-1">(</span><span class="hl-2">toHandler</span><span class="hl-1">);</span>
</code><button type="button">Copy</button></pre>

<a id="sqs-trigger-handler" class="tsd-anchor"></a><h3 class="tsd-anchor-link">SQS Trigger Handler<a href="#sqs-trigger-handler" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-0">import</span><span class="hl-1"> { </span><span class="hl-2">SQSEvent</span><span class="hl-1">, </span><span class="hl-2">toLambdaHandler</span><span class="hl-1"> } </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-3">&quot;effect-lambda/Sqs&quot;</span><span class="hl-1">;</span><br/><span class="hl-0">import</span><span class="hl-1"> { </span><span class="hl-2">Effect</span><span class="hl-1"> } </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-3">&quot;effect&quot;</span><span class="hl-1">;</span><br/><span class="hl-0">export</span><span class="hl-1"> </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">handler</span><span class="hl-1"> = </span><span class="hl-6">toLambdaHandler</span><span class="hl-1">(</span><br/><span class="hl-1">  </span><span class="hl-2">SQSEvent</span><span class="hl-1">.</span><span class="hl-6">pipe</span><span class="hl-1">(</span><br/><span class="hl-1">    </span><span class="hl-2">Effect</span><span class="hl-1">.</span><span class="hl-6">map</span><span class="hl-1">((</span><span class="hl-2">event</span><span class="hl-1">) </span><span class="hl-4">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-8">// Do something with the event</span><br/><span class="hl-1">    }),</span><br/><span class="hl-1">  ),</span><br/><span class="hl-1">);</span>
</code><button type="button">Copy</button></pre>

<p>You can also use a record processor to process each record in a batch individually.</p>
<pre><code class="typescript"><span class="hl-0">import</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-2">SQSRecord</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-2">toLambdaHandler</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-2">recordProcessorAdapter</span><span class="hl-1">,</span><br/><span class="hl-1">} </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-3">&quot;effect-lambda/Sqs&quot;</span><span class="hl-1">;</span><br/><span class="hl-0">import</span><span class="hl-1"> { </span><span class="hl-2">Effect</span><span class="hl-1"> } </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-3">&quot;effect&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">processRecord</span><span class="hl-1"> = </span><span class="hl-2">SQSRecord</span><span class="hl-1">.</span><span class="hl-6">pipe</span><span class="hl-1">(</span><br/><span class="hl-1">  </span><span class="hl-2">Effect</span><span class="hl-1">.</span><span class="hl-6">map</span><span class="hl-1">((</span><span class="hl-2">record</span><span class="hl-1">) </span><span class="hl-4">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-8">// Do something with the record</span><br/><span class="hl-1">  }),</span><br/><span class="hl-1">);</span><br/><br/><span class="hl-0">export</span><span class="hl-1"> </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">handler</span><span class="hl-1"> = </span><span class="hl-6">toLambdaHandler</span><span class="hl-1">(</span><br/><span class="hl-1">  </span><span class="hl-2">processRecord</span><span class="hl-1">.</span><span class="hl-6">pipe</span><span class="hl-1">(</span><span class="hl-2">recordProcessorAdapter</span><span class="hl-1">),</span><br/><span class="hl-1">);</span>
</code><button type="button">Copy</button></pre>

<a id="sns-trigger-handler" class="tsd-anchor"></a><h3 class="tsd-anchor-link">SNS Trigger Handler<a href="#sns-trigger-handler" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-0">import</span><span class="hl-1"> { </span><span class="hl-2">SNSEvent</span><span class="hl-1">, </span><span class="hl-2">toLambdaHandler</span><span class="hl-1"> } </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-3">&quot;effect-lambda/Sns&quot;</span><span class="hl-1">;</span><br/><span class="hl-0">import</span><span class="hl-1"> { </span><span class="hl-2">Effect</span><span class="hl-1"> } </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-3">&quot;effect&quot;</span><span class="hl-1">;</span><br/><span class="hl-0">export</span><span class="hl-1"> </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">handler</span><span class="hl-1"> = </span><span class="hl-6">toLambdaHandler</span><span class="hl-1">(</span><br/><span class="hl-1">  </span><span class="hl-2">SQSEvent</span><span class="hl-1">.</span><span class="hl-6">pipe</span><span class="hl-1">(</span><br/><span class="hl-1">    </span><span class="hl-2">Effect</span><span class="hl-1">.</span><span class="hl-6">map</span><span class="hl-1">((</span><span class="hl-2">event</span><span class="hl-1">) </span><span class="hl-4">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-8">// Do something with the event</span><br/><span class="hl-1">    }),</span><br/><span class="hl-1">  ),</span><br/><span class="hl-1">);</span>
</code><button type="button">Copy</button></pre>

<a id="dynamodb-stream-event-handler" class="tsd-anchor"></a><h3 class="tsd-anchor-link">DynamoDB Stream Event Handler<a href="#dynamodb-stream-event-handler" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="typescript"><span class="hl-8">// handler.ts</span><br/><span class="hl-0">import</span><span class="hl-1"> { </span><span class="hl-2">toLambdaHandler</span><span class="hl-1"> } </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-3">&quot;effect-lambda/DynamoDb&quot;</span><span class="hl-1">;</span><br/><span class="hl-0">import</span><span class="hl-1"> { </span><span class="hl-2">Effect</span><span class="hl-1"> } </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-3">&quot;effect&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-0">export</span><span class="hl-1"> </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">handler</span><span class="hl-1"> = </span><span class="hl-6">toLambdaHandler</span><span class="hl-1">(</span><br/><span class="hl-1">  </span><span class="hl-2">Effect</span><span class="hl-1">.</span><span class="hl-6">map</span><span class="hl-1">((</span><span class="hl-2">event</span><span class="hl-1">) </span><span class="hl-4">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-2">event</span><span class="hl-1">.</span><span class="hl-2">Records</span><span class="hl-1">.</span><span class="hl-6">forEach</span><span class="hl-1">((</span><span class="hl-2">record</span><span class="hl-1">) </span><span class="hl-4">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-8">// Process each record</span><br/><span class="hl-1">      </span><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-6">log</span><span class="hl-1">(</span><span class="hl-3">&quot;DynamoDB Record: %j&quot;</span><span class="hl-1">, </span><span class="hl-2">record</span><span class="hl-1">);</span><br/><span class="hl-1">    });</span><br/><span class="hl-1">  }),</span><br/><span class="hl-1">);</span>
</code><button type="button">Copy</button></pre>

<p>This handler allows you to process DynamoDB stream events in a functional way using the <code>effect-lambda</code> library. You can access each record in the stream and apply your business logic accordingly.</p>
<a id="useful-other-libraries-to-use-with-effect-lambda" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Useful other libraries to use with effect-lambda<a href="#useful-other-libraries-to-use-with-effect-lambda" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><ul>
<li><a href="https://effect.website">effect</a> - Well you got to have this one to use this library :wink:
<ul>
<li><code>@effect/schema</code> - Peer dependency of this library for schemas</li>
<li><code>@effect/platform-node</code> - Fully effect native library for network requests, file system, etc.</li>
</ul>
</li>
<li><a href="https://github.com/floydspace/effect-aws">effect-aws</a> - Effect wrapper for common AWS services like S3, DynamoDB, SNS, SQS, etc.</li>
</ul>
<a id="todo-list" class="tsd-anchor"></a><h2 class="tsd-anchor-link">TODO list<a href="#todo-list" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><p>Effect friendly wrapper for AWS Lambdas</p>
<ul>
<li>[x] APIGatewayProxyHandler - REST api or HTTP api with payload version 1</li>
<li>[x] SQS Trigger</li>
<li>[x] DynamoDB Trigger</li>
<li>[x] Utility to deal with an array of records and produce a batchItemFailures response upon failures</li>
<li>[x] Authorizer Trigger</li>
<li>[x] SNS Trigger</li>
<li>[x] Change API naming to use namespaces</li>
<li>[x] Add documentation</li>
<li>[x] Set up GitHub actions</li>
<li>[ ] APIGatewayProxyHandlerV2 - HTTP api with payload version 2</li>
<li>[ ] S3 Put Event Handler</li>
<li>[ ] S3 Delete Event Handler</li>
<li>[ ] SES Trigger</li>
<li>[ ] EventBridge Trigger</li>
<li>[x] Add Lambda runtime to allow graceful shutdown and clearing up of resources</li>
<li>[ ] Add content negotiation for API Gateway Handlers</li>
</ul>
</div></div><div class="col-sidebar"><div class="page-menu"><div class="tsd-navigation settings"><details class="tsd-accordion"><summary class="tsd-accordion-summary"><h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true"><use href="assets/icons.svg#icon-chevronDown"></use></svg>Settings</h3></summary><div class="tsd-accordion-details"><div class="tsd-filter-visibility"><span class="settings-label">Member Visibility</span><ul id="tsd-filter-options"><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-protected" name="protected"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Protected</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-inherited" name="inherited" checked/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Inherited</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-external" name="external"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>External</span></label></li></ul></div><div class="tsd-theme-toggle"><label class="settings-label" for="tsd-theme">Theme</label><select id="tsd-theme"><option value="os">OS</option><option value="light">Light</option><option value="dark">Dark</option></select></div></div></details></div><details open class="tsd-accordion tsd-page-navigation"><summary class="tsd-accordion-summary"><h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true"><use href="assets/icons.svg#icon-chevronDown"></use></svg>On This Page</h3></summary><div class="tsd-accordion-details"><a href="#effect-lambda"><span>effect-<wbr/>lambda</span></a><ul><li><a href="#motivation"><span>Motivation</span></a></li><li><a href="#main-concepts--caveats"><span>Main <wbr/>Concepts &amp; <wbr/>Caveats</span></a></li><li><a href="#table-of-contents"><span>Table of <wbr/>Contents</span></a></li><li><a href="#installation"><span>Installation</span></a></li><li><a href="#usage"><span>Usage</span></a></li><li><ul><li><a href="#api-gateway-proxy-handler"><span>API <wbr/>Gateway <wbr/>Proxy <wbr/>Handler</span></a></li><li><a href="#sqs-trigger-handler"><span>SQS <wbr/>Trigger <wbr/>Handler</span></a></li><li><a href="#sns-trigger-handler"><span>SNS <wbr/>Trigger <wbr/>Handler</span></a></li><li><a href="#dynamodb-stream-event-handler"><span>DynamoDB <wbr/>Stream <wbr/>Event <wbr/>Handler</span></a></li></ul></li><li><a href="#useful-other-libraries-to-use-with-effect-lambda"><span>Useful other libraries to use with effect-<wbr/>lambda</span></a></li><li><a href="#todo-list"><span>TODO list</span></a></li></ul></div></details></div><div class="site-menu"><nav class="tsd-navigation"><a href="modules.html">effect-lambda</a><ul class="tsd-small-nested-navigation" id="tsd-nav-container"><li>Loading...</li></ul></nav></div></div></div><footer><p class="tsd-generator">Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p></footer><div class="overlay"></div></body></html>
